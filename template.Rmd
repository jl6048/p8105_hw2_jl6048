---
title: "p8105_hw2_jl6048"
output: github_document
author: Jinghan Liu
---

```{r}
library(tidyverse)
library(readxl)
library(lubridate)
```

## Problem 1a

#Read and clean the Mr. Trash Wheel sheet
```{r message=FALSE}
Trash_df = 
  read_excel("Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = "Mr. Trash Wheel" ,range ="A2:N535") %>%
  janitor::clean_names() %>%
  drop_na(dumpster,month) %>%
  mutate(sports_balls = round(sports_balls)) 
Trash_df
```


## Problem 1b

#Read and clean precipitation data for 2018 and 2019
```{r message=FALSE}
data2019_df = 
  read_excel("Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = "2019 Precipitation" ,range ="A2:B14") %>%
  janitor::clean_names() %>%
  mutate(year = 2019)
data2019_df

data2018_df = 
  read_excel("Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = "2018 Precipitation" ,range ="A2:B14") %>%
  janitor::clean_names() %>%
  mutate(year = 2018) 
data2018_df
```

#combine precipitation datasets
```{r message=FALSE}
data_df =
  bind_rows(data2019_df, data2018_df)%>%
  mutate(month = month.name[month])
data_df
```

#description


Write a paragraph about these data; you are encouraged to use inline R. Be sure to note the number of observations in both resulting datasets, and give examples of key variables. For available data, what was the total precipitation in 2018? What was the median number of sports balls in a dumpster in 2019?



##Problem 2
```{r message=FALSE}
pols_df = 
  read_csv("data/pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(mon, into = c("year", "month", "day"), convert = TRUE) %>%
  mutate(month = month.abb[month])
pols_df


pols_tidy =
  pols_df %>%
  pivot_longer(
    c(prez_gop, prez_dem),
    names_to = "president",
    names_prefix = "prez_",
    values_to = "dbi") %>%
    select(-day) %>%
  filter(dbi != 0) %>%
    select(-dbi)
pols_tidy

```

```{r message=FALSE}
snp_df = 
  read_csv("data/snp.csv") %>%
  janitor::clean_names() %>%
  separate(date, into = c("month","day","year"), convert = TRUE)%>%
   mutate(
     year = ifelse(year<= 15, year + 2000, year + 1900),
     month = month.abb[month]) %>%
  select(year, month, close)
snp_df
```

```{r message=FALSE}
une_df = 
  read_csv("data/unemployment.csv") %>%
  pivot_longer(
    Jan:Dec,
    names_to = "month",
    values_to = "unemployment")%>%
  janitor::clean_names() 
une_df
 
```

```{r message=FALSE}
pols_snp_df =
  full_join(pols_tidy, snp_df)
all_df =
  full_join(pols_snp_df, une_df)
all_df
```


##Problem 3
```{r}
pbn_df = 
  read_csv("Popular_Baby_Names.csv") %>%
  janitor::clean_names() %>%
  mutate( gender = str_to_lower(gender), 
          childs_first_name = str_to_lower(childs_first_name),
          ethnicity = str_to_lower(ethnicity),  
          ethnicity = recode(ethnicity, "white non hisp" = "white non hispanic", "asian and paci" = "asian and pacific islander", "black non hisp" = "black non hispanic"))%>%
  distinct()
pbn_df
```


```{r message=FALSE}
olivia_df = 
  filter(pbn_df,
    gender == "female",
    childs_first_name == "olivia") %>%
  select(year_of_birth, ethnicity, rank) %>%
  pivot_wider(
    names_from = "year_of_birth",
    values_from = "rank") %>%
  knitr::kable()
olivia_df
```

```{r message=FALSE}
male_df = 
  filter(pbn_df,
    gender == "male",
    rank == 1) %>%
  select(year_of_birth, ethnicity, childs_first_name) %>%
  pivot_wider(
    names_from = "year_of_birth",
    values_from = "childs_first_name") %>%
  knitr::kable()
male_df
```

```{r message=FALSE}
male_white_2016 =
  filter(pbn_df,
         gender == "male",
         year_of_birth == "2016",
         ethnicity == "white non hispanic")%>%
  ggplot(aes(x = rank, y = count)) +
  geom_point() + 
  geom_text(aes(label = childs_first_name)) +
  labs(title = "white non-hispanic male children name rank in 2016",
       x = "Rank of name",
       y = "number of name")
male_white_2016
```

